<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<title>Three.JS FPS</title>
		<link rel="stylesheet" href="fpsexample.css" type="text/css" media="screen">
	</head>
	<body id="body" style="width:100%; height:100%">
        <script type="text/javascript" src="libraries/three.js"></script>
		<script src="FirstPersonControls.js"></script>
		<script src="worldmanager.js"></script>
		<script src="enemymanager.js"></script>
		<script src="networkmanager.js"></script>
        <script src="MotionControls.js"></script>
		<!--<div id="blocker">
			<div id="instructions">
				<span style="font-size:40px">Click to play</span>
				<br />
				(W, A, S, D = Move, SPACE = Jump, MOUSE = Look around)
			</div>
		</div>-->
		<div id="health">         
			<div id="percent">Health: <span id="p"></span></div>
			<progress id="progress-bar" value="100" max="100"></progress>
		</div>
        <!--Not good at CSS. Cant figure out how to overlay the cross hair onto the canvas. -GOSAR--> 
            <img class="crosshair"  src="Textures/crosshair.png" />

		<script src="fpsexample.js"></script>
        <script>
            var delta = 1 / 60;
            var accPresent = false;
            if (navigator.userAgent.match(/Android|BlackBerry|iPhone|iPad|iPod|Opera Mini|IEMobile/i)
                && window.DeviceMotionEvent)
                accPresent = true;

            function onOrientationChange() {
                var body = document.getElementById('body');
                var deg = 0;
                switch (window.orientation) {
                    case -90:
                        isPaused = false;
                        break;
                    case 90:
                    default:
                        alert('You should only play this game is Landscape left');
                        isPaused = true;
                        break;
                }
            }
            window.addEventListener('orientationchange', onOrientationChange);
            
            if (accPresent) {
                this.ondevicemotion = accleration;
                this.ondeviceorientation = accleration;
            }

            function accleration(event) {
                if (event.type === 'devicemotion') {
                    var x = event.accelerationIncludingGravity.x;
                    var z = event.accelerationIncludingGravity.z;
                    var y = event.accelerationIncludingGravity.y;
                    if (x != null && y != null && z != null) {
                        if (x < -1) {
                            controls.accForward = true;
                        }
                        if (z > 11 || z < 9) {
                            if (controls.canJump == true) {
                                controls.moveJump = true;
                            }
                            else {
                                controls.canJump = false;
                            }
                        }

                        if (y > 0.5) {
                            controls.accRight = true;
                        }
                        else
                            if (y < -0.5) {
                                controls.accLeft = true;
                            }

                        if (x > 4.85) {
                            controls.accBackward = true;
                        }

                        if (x > 6 && x < -3)
                            controls.isSprinting = true;
                        else
                            controls.isSprinting = false;

                    }
                }                
            }

            this.addEventListener("touchstart", touchStart, false);
            this.addEventListener("touchmove", touchMove, false);
            this.addEventListener("touchend", touchEnd, false);
            var start = { x: 0, y: 0 };

            function touchEnd() {
                start = { x: 0, y: 0 };
                controls.mouseX = 0;
                controls.mouseY = 0;
            }

            function touchStart(e) {
                start.x = event.touches[0].pageX;
                start.y = event.touches[0].pageY;
            }

            var rotationSpeed = 0.25;
            function touchMove(e) {
                offset = {};
                offset.x = start.x - event.touches[0].pageX;
                offset.y = start.y - event.touches[0].pageY;
                controls.mouseX = -offset.x * rotationSpeed;
                controls.mouseY = -offset.y * rotationSpeed;
            }

            function degInRad(w) {
                return w * Math.PI / 180;
            }
        </script>
	</body>
</html>